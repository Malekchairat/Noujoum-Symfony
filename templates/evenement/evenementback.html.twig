{% extends 'backoffice.html.twig' %}

{% block title %}Evenements Management{% endblock %}

{% block body %}
<div style="background-color: #303234; padding: 40px; border-radius: 10px; margin-top: 50px;">
    <h1 class="text-center" style="margin-bottom: 30px; color: gold;">🎭 Gestion evenements </h1>

    {# Display flash messages #}
        {% for label, messages in app.flashes %}
            {% for message in messages %}
                <div class="alert alert-{{ label }}" style="margin-bottom: 20px;">
                    {{ message }}
                </div>
            {% endfor %}
        {% endfor %}


    <div class="text-end" style="margin-bottom: 40px;">
        <a href="{{ path('evenement_new') }}" style="
           background-color: gold; 
           color: black; 
           padding: 10px 20px; 
           border-radius: 5px; 
           text-decoration: none; 
           font-weight: 600;">
            ➕ Creer nouveau evenement
        </a>
        <a href="{{ path('ticket_back') }}" style="
           margin-left: 10px;
           background-color: gold; 
           color: black; 
           padding: 10px 20px; 
           border-radius: 5px; 
           text-decoration: none; 
           font-weight: 600;">
             🎫Voir Tickets
        </a>
        <a href="{{ path('evenement_stat') }}" style="
            margin-left: 10px;
            background-color: gold; 
            color: black; 
            padding: 10px 20px; 
            border-radius: 5px; 
            text-decoration: none; 
            font-weight: 600;">
             📊 Voir Statistics
        </a>
    </div>

    <div style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center;">
        {% for evenement in evenements %}
            <div style="width: 350px; background-color: black; border: 2px solid gold; color: white; border-radius: 10px; overflow: hidden; display: flex; flex-direction: column;">
                {% if evenement.image %}
                    <img src="{{ asset('uploads/' ~ evenement.image) }}" alt="{{ evenement.Titre }}" style="width: 100%; height: 180px; object-fit: cover; display: block;">
                {% endif %}
                <div style="padding: 15px;">
                    <h5 style="margin-bottom: 10px; color: gold;">🎫 {{ evenement.Titre }}</h5>
                    <p>📜 <strong>Description:</strong> {{ evenement.Description|slice(0, 100) }}</p>
                    <p>📅 <strong>Date:</strong> {{ evenement.dateDebut|date('Y-m-d') }} → {{ evenement.dateFin|date('Y-m-d') }}</p>
                    <p>📍 <strong>Lieu:</strong> {{ evenement.Lieu }}</p>
                    <p>💰 <strong>Prix:</strong> {{ evenement.Prix }} TND</p>
                    <p>🎶 <strong>Type:</strong> {{ evenement.TypeE }}</p>
                    <p>🎤 <strong>Artiste:</strong> {{ evenement.artiste }}</p>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <a href="{{ path('evenement_edit', {'id': evenement.id}) }}" style="
                               border: 1px solid gold; 
                               color: gold; 
                               background: transparent; 
                               border-radius: 5px; 
                               padding: 5px 10px; 
                               text-decoration: none;">
                                Modifier
                        </a>
                        <form method="POST" action="{{ path('evenement_delete', {'id': evenement.id}) }}" onsubmit="return confirm('Are you sure you want to delete this event?');" style="display:inline;">
                            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ evenement.id) }}">
                            <button type="submit" style="
                                    background-color: red; 
                                    border: none; 
                                    border-radius: 5px; 
                                    padding: 5px 10px; 
                                    color: white; 
                                    text-decoration: none;
                                    cursor: pointer;
                                ">
                                Supprimer
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        {% else %}
            <p class="text-center text-white">No events found.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}