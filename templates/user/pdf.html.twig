<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Liste des utilisateurs</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            font-size: 12px; 
            margin: 1cm;
        }
        h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 20px;
            page-break-inside: auto;
        }
        th, td { 
            border: 1px solid #ddd; 
            padding: 8px; 
            text-align: left;
        }
        th { 
            background-color: #34495e; 
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .user-photo {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: bold;
        }
        .bg-warning {
            background-color: #f39c12;
            color: white;
        }
        .bg-info {
            background-color: #3498db;
            color: white;
        }
        .bg-secondary {
            background-color: #95a5a6;
            color: white;
        }
        .footer {
            margin-top: 20px;
            text-align: right;
            font-size: 10px;
            color: #7f8c8d;
        }
    </style>
</head>
<body>
    <h2>Liste des utilisateurs{% if role %} - Rôle : {{ role }}{% endif %}</h2>
    
    <table>
        <thead>
            <tr>
                <th width="10%">Photo</th>
                <th width="25%">Nom</th>
                <th width="25%">Email</th>
                <th width="15%">Téléphone</th>
                <th width="15%">Rôle</th>
               
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
                <tr>
                    <td>
                        {% if user.image %}
                            <img src="{{ absolute_url(asset('uploads/' ~ user.image)) }}" alt="Photo de {{ user.prenom }}" class="user-photo">
                        {% else %}
                            <img src="{{ absolute_url(asset('uploads/user.png')) }}" alt="Photo par défaut" class="user-photo">
                        {% endif %}
                    </td>
                    <td>{{ user.prenom }} {{ user.nom }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.tel|default('N/A') }}</td>
                    <td>
                        {% if user.role.value == 'ROLE_ADMIN' %}
                            <span class="badge bg-warning">Admin</span>
                        {% elseif user.role.value == 'ROLE_USER' %}
                            <span class="badge bg-info">Fan</span>
                        {% else %}
                            <span class="badge bg-secondary">{{ user.role.value }}</span>
                        {% endif %}
                    </td>
                    
                </tr>  
            {% else %}
                <tr>
                    <td colspan="6" style="text-align: center;">Aucun utilisateur trouvé.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div class="footer">
        Généré le {{ "now"|date("d/m/Y H:i") }} | Total: {{ users|length }} utilisateurs
    </div>
</body>
</html>